<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TitanFlow Analytics Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: #0A1628;
            color: white;
            padding: 2rem;
        }

        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #00E5A0, #6366F1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: #B8C5D6;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00E5A0;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #B8C5D6;
            font-size: 1rem;
        }

        .section {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section h2 {
            margin-bottom: 1.5rem;
            color: #00E5A0;
        }

        .leads-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leads-table th,
        .leads-table td {
            text-align: left;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leads-table th {
            background: rgba(0, 229, 160, 0.1);
            color: #00E5A0;
            font-weight: 600;
        }

        .button {
            background: linear-gradient(135deg, #00E5A0, #00C78A);
            color: #0A1628;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin: 0.5rem;
            transition: transform 0.2s ease;
        }

        .button:hover {
            transform: translateY(-2px);
        }

        .json-output {
            background: #1E3A5F;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .empty-state {
            text-align: center;
            color: #B8C5D6;
            padding: 2rem;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .leads-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>TitanFlow Analytics Dashboard</h1>
            <p>Track website performance and lead capture for market validation</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalLeads">0</div>
                <div class="stat-label">Total Leads</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="todayLeads">0</div>
                <div class="stat-label">Leads Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="conversionRate">0%</div>
                <div class="stat-label">Conversion Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgTimeOnSite">0s</div>
                <div class="stat-label">Avg. Time on Site</div>
            </div>
        </div>

        <div class="section">
            <h2>Recent Leads</h2>
            <div style="margin-bottom: 1rem;">
                <button class="button" onclick="refreshData()">Refresh Data</button>
                <button class="button" onclick="exportLeads()">Export CSV</button>
                <button class="button" onclick="clearData()" style="background: #dc3545;">Clear Data</button>
            </div>
            
            <div id="leadsContainer">
                <div class="empty-state">
                    <p>No leads captured yet. Visit your website to start collecting data!</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Analytics Events</h2>
            <p style="color: #B8C5D6; margin-bottom: 1rem;">
                Track user interactions: page views, button clicks, form submissions, scroll depth, and more.
            </p>
            <div id="analyticsContainer">
                <div class="empty-state">
                    <p>Analytics events will appear here as users interact with your site.</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Traffic Sources</h2>
            <div id="trafficSourcesContainer">
                <div class="empty-state">
                    <p>Traffic source data will appear here.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let analyticsEvents = JSON.parse(localStorage.getItem('titanflow_analytics') || '[]');
        
        // Simulate analytics tracking for demo purposes
        function simulateAnalyticsEvent(action, category, label = '') {
            const event = {
                timestamp: new Date().toISOString(),
                action: action,
                category: category,
                label: label,
                page: window.location.pathname,
                userAgent: navigator.userAgent,
                referrer: document.referrer
            };
            
            analyticsEvents.push(event);
            localStorage.setItem('titanflow_analytics', JSON.stringify(analyticsEvents));
        }

        function refreshData() {
            loadLeads();
            updateStats();
            loadAnalytics();
            loadTrafficSources();
        }

        function loadLeads() {
            const leads = JSON.parse(localStorage.getItem('titanflow_leads') || '[]');
            const container = document.getElementById('leadsContainer');
            
            if (leads.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>No leads captured yet. Visit your website to start collecting data!</p></div>';
                return;
            }

            let html = `
                <table class="leads-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Contact</th>
                            <th>Company</th>
                            <th>Industry</th>
                            <th>Source</th>
                            <th>Challenges</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            leads.reverse().forEach(lead => {
                const date = new Date(lead.timestamp).toLocaleDateString();
                const contact = lead.firstName ? `${lead.firstName} ${lead.lastName}` : 'Email Signup';
                const email = lead.email || 'N/A';
                const company = lead.company || 'N/A';
                const industry = lead.industry || 'N/A';
                const source = lead.source || 'N/A';
                const challenges = lead.currentChallenges ? 
                    (lead.currentChallenges.length > 50 ? lead.currentChallenges.substring(0, 50) + '...' : lead.currentChallenges) 
                    : 'N/A';
                
                html += `
                    <tr>
                        <td>${date}</td>
                        <td>
                            <strong>${contact}</strong><br>
                            <small style="color: #B8C5D6;">${email}</small>
                        </td>
                        <td>${company}</td>
                        <td>${industry}</td>
                        <td>${source}</td>
                        <td>${challenges}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function updateStats() {
            const leads = JSON.parse(localStorage.getItem('titanflow_leads') || '[]');
            const today = new Date().toDateString();
            
            document.getElementById('totalLeads').textContent = leads.length;
            
            const todayLeads = leads.filter(lead => 
                new Date(lead.timestamp).toDateString() === today
            ).length;
            document.getElementById('todayLeads').textContent = todayLeads;
            
            // Simulate conversion rate (in real app, this would come from actual visitor count)
            const conversionRate = leads.length > 0 ? Math.min((leads.length / (leads.length + 50)) * 100, 15) : 0;
            document.getElementById('conversionRate').textContent = conversionRate.toFixed(1) + '%';
            
            // Simulate average time on site
            const avgTime = Math.floor(Math.random() * 180) + 45; // 45-225 seconds
            document.getElementById('avgTimeOnSite').textContent = avgTime + 's';
        }

        function loadAnalytics() {
            const events = analyticsEvents.slice(-20); // Show last 20 events
            const container = document.getElementById('analyticsContainer');
            
            if (events.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Analytics events will appear here as users interact with your site.</p></div>';
                return;
            }

            let html = '<div class="json-output">';
            events.reverse().forEach(event => {
                html += `${new Date(event.timestamp).toLocaleString()}: ${event.action} (${event.category})\n`;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        function loadTrafficSources() {
            const events = analyticsEvents.filter(event => event.action === 'traffic_source');
            const container = document.getElementById('trafficSourcesContainer');
            
            if (events.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Traffic source data will appear here.</p></div>';
                return;
            }

            const sources = {};
            events.forEach(event => {
                sources[event.label] = (sources[event.label] || 0) + 1;
            });

            let html = '<table class="leads-table"><thead><tr><th>Source</th><th>Visits</th></tr></thead><tbody>';
            Object.entries(sources).forEach(([source, count]) => {
                html += `<tr><td>${source}</td><td>${count}</td></tr>`;
            });
            html += '</tbody></table>';
            
            container.innerHTML = html;
        }

        function exportLeads() {
            const leads = JSON.parse(localStorage.getItem('titanflow_leads') || '[]');
            
            if (leads.length === 0) {
                alert('No leads to export');
                return;
            }

            const csvContent = "data:text/csv;charset=utf-8," + 
                "Date,First Name,Last Name,Email,Company,Industry,Team Size,Challenges,Source\n" +
                leads.map(lead => {
                    const date = new Date(lead.timestamp).toLocaleDateString();
                    return [
                        date,
                        lead.firstName || '',
                        lead.lastName || '',
                        lead.email || '',
                        lead.company || '',
                        lead.industry || '',
                        lead.teamSize || '',
                        (lead.currentChallenges || '').replace(/,/g, ';'),
                        lead.source || ''
                    ].map(field => `"${field}"`).join(',');
                }).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `titanflow-leads-${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearData() {
            if (confirm('Are you sure you want to clear all analytics data? This cannot be undone.')) {
                localStorage.removeItem('titanflow_leads');
                localStorage.removeItem('titanflow_analytics');
                analyticsEvents = [];
                refreshData();
                alert('Data cleared successfully');
            }
        }

        // Add some sample events for demo
        function addSampleData() {
            const sampleEvents = [
                { action: 'page_view', category: 'navigation', label: '' },
                { action: 'traffic_source', category: 'attribution', label: 'google/organic' },
                { action: 'scroll_25', category: 'engagement', label: '' },
                { action: 'hover_feature_card', category: 'engagement', label: 'card_1' },
                { action: 'traffic_source', category: 'attribution', label: 'direct/none' },
            ];

            sampleEvents.forEach(event => {
                simulateAnalyticsEvent(event.action, event.category, event.label);
            });
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Add sample data if no data exists
            if (analyticsEvents.length === 0) {
                addSampleData();
            }
            
            refreshData();
            
            // Auto-refresh every 30 seconds
            setInterval(refreshData, 30000);
        });
    </script>
</body>
</html>